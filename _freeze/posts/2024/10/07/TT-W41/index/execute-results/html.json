{
  "hash": "02b85eebfcaf994b3daaa08713e73704",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Bird Abundance \"\ndate: \"2024-10-08\"\nformat:\n  html:\n    page-layout: full\n    html-math-method: katex\ncategories:\n  - \"#TidyTuesday\"\n  - data visualisation\nimage: \"../../../thumbnails/tt_2024_w41_thumb.png\"\ncitation:\n  url: \"https://c-monaghan.github.io/posts/2024/10/07/TT-W41/\"\nexecute:\n  warning: false\neditor: source\n---\n\n![The image displays the abundance of birds for the 15 most visited National Parks in the USA](tt_2024_w41.png){#fig-bird .lightbox}\n\nThis document analyzes a dataset of species from the 15 most visited [National Parks](https://irma.nps.gov/NPSpecies/Search/SpeciesList) in the USA provided by [#TidyTuesday](https://github.com/rfordatascience/tidytuesday). The main focus of this analysis will be on **birds**.\n\n# Setting up\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Loading packages -------------------------------------------------------------\npacman::p_load(\n  tidyverse,        # Easily Install and Load the 'Tidyverse'\n  ggtext,           # Improved Text Rendering Support for 'ggplot2'\n  showtext,         # Using Fonts More Easily in R Graphs\n  ggeasy,           # Makes theming plots easier\n  glue,             # Interpreted String Literals\n  ggfx              # Pixel Filters for \"ggplot2\" and \"grid\"\n)\n\n# Visualization Parameters -----------------------------------------------------\n# Plot aesthetics\ntitle_col    <- \"gray20\"\nsubtitle_col <- \"gray20\"\ncaption_col  <- \"gray30\"\ntext_col     <- \"gray20\"\n\n# Icons\ntt <- str_glue(\"#TidyTuesday: { 2024 } Week { 41 } &bull; Source: National Park Species<br>\")\nli <- str_glue(\"<span style='font-family:fa6-brands'>&#xf08c;</span>\")\ngh <- str_glue(\"<span style='font-family:fa6-brands'>&#xf09b;</span>\")\n\n# Text\ntitle_text <- str_glue(\"Abundance of birds per national park\")\ncaption_text  <- str_glue(\"{tt} {li} c-monaghan &bull; {gh} c-monaghan &bull; #rstats #ggplot2\")\n\n# Fonts\nfont_add(\"fa6-brands\", here::here(\"fonts/6.4.2/Font Awesome 6 Brands-Regular-400.otf\"))\nfont_add_google(\"Oswald\", regular.wt = 400, family = \"title\")\nfont_add_google(\"Noto Sans\", regular.wt = 400, family = \"caption\")\nfont_add_google(\"Merriweather Sans\", regular.wt = 400, family = \"text\")\nshowtext_auto(enable = TRUE)\n\n# Theme\ntheme_set(theme_minimal(base_size = 14))\n\ntheme_update(\n  plot.title.position   = \"plot\",\n  plot.caption.position = \"plot\",\n  panel.background      = element_rect(fill = \"white\", color = \"white\"),\n  panel.grid            = element_blank(),\n  panel.grid.major.x    = element_blank(),\n  axis.text.x           = element_text(size = 12, family = \"text\"),\n  axis.text.y           = element_blank(),\n  legend.position       = \"bottom\"\n)\n\n# Variables --------------------------------------------------------------------\n# Paths\npath <- \"posts/2024/10/07\"\nfolder <- \"TT-W41/\"\n\n# Reading in data --------------------------------------------------------------\ndata <- tidytuesdayR::tt_load(2024, week = 41)\n\nspecies <- data$most_visited_nps_species_data\n```\n:::\n\n\n# Species data\nThe dataset includes various information on animal and plant species from 15 of the most visited parks in the USA. In particular, we are interested in the abundance of birds in each park.\n\n## Calculating abundance\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbird_abundance <- species %>%\n  select(ParkName, CategoryName) %>%\n  group_by(ParkName, CategoryName) %>%\n  summarise(Abundance = n()) %>%\n  rename(Park_name = ParkName, Species = CategoryName)  %>%\n  mutate(Park_name = as.factor(Park_name)) %>%\n  filter(Species == \"Bird\")\n\nbird_abundance %>%\n  head()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 Ã— 3\n# Groups:   Park_name [6]\n  Park_name                     Species Abundance\n  <fct>                         <chr>       <int>\n1 Acadia National Park          Bird          364\n2 Bryce Canyon National Park    Bird          218\n3 Cuyahoga Valley National Park Bird          246\n4 Glacier National Park         Bird          277\n5 Grand Canyon National Park    Bird          456\n6 Grand Teton National Park     Bird          266\n```\n\n\n:::\n:::\n\n\n# Visualising bird abundance\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nbird_abundance_plot <- bird_abundance %>%\n  ggplot() +\n\n  # Add horizontal reference lines at intervals of 125\n  geom_hline(\n    data = data.frame(y = c(0:4) * 125),\n    aes(yintercept = y),\n    color = \"lightgrey\") +\n\n  # Create a bar plot in polar coordinates\n  geom_col(\n    aes(x = reorder(str_wrap(Park_name, 16), Abundance),\n        y = Abundance,\n        fill = Abundance),\n    position = \"dodge2\", show.legend = TRUE, alpha = 0.9) +\n\n  # Use polar coordinates\n  coord_polar() +\n\n  # Set y-axis limits, expand to control padding, and custom breaks for reference lines\n  scale_y_continuous(\n    limits = c(-200, 500),\n    expand = c(0, 0),\n    breaks = c(0, 100, 200, 300, 400)\n  ) +\n\n  # Apply a color gradient for the bars based on abundance levels\n  scale_fill_gradientn(\n    \"Abundance\", # Title\n    colours = c( \"#e9b91c\",\"#db9a17\",\"#ce7b12\",\"#be471b\", \"#ae1324\") # Custom colours\n  ) +\n\n  # Customize the legend\n  guides(\n    fill = guide_colorsteps(\n      barwidth = 15,\n      barheight = 1,\n      title.position = \"top\",\n      title.hjust = .5\n    )) +\n\n  # Add titles and labels\n  labs(\n    title = title_text,\n    caption = caption_text,\n    x = NULL,\n    y = NULL) +\n\n  # Apply theme customization\n  theme(\n    # Title\n    plot.title = element_text(\n      size = rel(5),\n      family = \"title\",\n      face = \"bold\",\n      colour = title_col,\n      lineheight = 1.1,\n      hjust = 0.5,\n      margin = margin(t = 5, b = 5)),\n    # Caption\n    plot.caption = element_markdown(\n      size = rel(1.25),\n      family = \"caption\",\n      colour = caption_col,\n      lineheight = 1.1,\n      hjust = 0.5,\n      margin = margin(t = 5, b = 5)),\n    legend.title = element_text(size = 20),\n    legend.text = element_text(size = 15)\n  )\n\nbird_abundance_plot\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/plotting-1.png){fig-align='center' width=864}\n:::\n:::\n\n\n# Saving\n\n::: {.cell}\n\n```{.r .cell-code}\n# Saving plot\nggsave(\n  filename = here::here(path, folder, \"tt_2024_w41.png\"),\n  plot = bird_abundance_plot,\n  width = 9,\n  height = 6,\n  units = \"in\",\n  dpi = 320\n  )\n\n# Thumbnail\nmagick::image_read(here::here(path, folder, \"tt_2024_w41.png\")) |>\n  magick::image_resize(geometry = \"800\") |>\n  magick::image_write(here::here(\"posts/2024/thumbnails/tt_2024_w41_thumb.png\"))\n```\n:::\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}